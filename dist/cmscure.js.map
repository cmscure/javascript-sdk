{"version":3,"file":"cmscure.js","sources":["../src/cmscure.js"],"sourcesContent":["/**\n * CMSCure JavaScript SDK\n * Official SDK for integrating CMSCure content management into web applications\n * \n * @version 1.2.6\n * @author CMSCure Team\n * @license MIT\n */\n\nclass CMSCureSDK extends EventTarget {\n  static #instance;\n\n  #config = null;\n  #authToken = null;\n  #cache = {};\n  #dataStoreCache = {};\n  #availableLanguages = ['en'];\n  #currentLanguage = 'en';\n  #isInitialized = false;\n  #serverUrl = 'https://gateway.cmscure.com';\n\n  constructor() {\n    super();\n    // Enforce singleton pattern to prevent multiple instances.\n    if (CMSCureSDK.#instance) {\n      console.log('[CMSCureSDK] Returning existing singleton instance.');\n      return CMSCureSDK.#instance;\n    }\n    CMSCureSDK.#instance = this;\n    console.log('[CMSCureSDK] Singleton instance created.');\n    this.#loadStateFromStorage();\n  }\n\n  /**\n   * Configures the SDK with project credentials and initializes authentication\n   * @param {Object} config - Configuration object\n   * @param {string} config.projectId - Your project ID from CMSCure Dashboard\n   * @param {string} config.apiKey - Your API key from CMSCure Dashboard\n   * @param {string} [config.defaultLanguage='en'] - Default language code\n   * @returns {Promise<void>}\n   */\n  async configure(config) {\n    if (this.#isInitialized) {\n      console.warn('[CMSCureSDK] SDK already configured.');\n      return;\n    }\n        \n    if (!config.projectId || !config.apiKey) {\n      console.error('[CMSCureSDK] Configuration failed: Project ID and API Key are required.');\n      return;\n    }\n        \n    this.#config = config;\n    this.#currentLanguage = config.defaultLanguage || this.#currentLanguage;\n        \n    console.log('[CMSCureSDK] Configuration set.');\n        \n    // Perform the initial sync\n    await this.#authenticateAndSync();\n    \n    this.#isInitialized = true;\n  }\n\n  /**\n   * Gets the current language\n   * @returns {string} Current language code\n   */\n  getLanguage() {\n    return this.#currentLanguage;\n  }\n\n  /**\n   * Sets the current language and updates the UI\n   * @param {string} language - Language code to set\n   */\n  setLanguage(language) {\n    if (this.#availableLanguages.includes(language)) {\n      this.#currentLanguage = language;\n      localStorage.setItem('cmscure_current_language', language);\n      this.dispatchEvent(new CustomEvent('languageChanged', { detail: { language } }));\n      this.dispatchEvent(new CustomEvent('contentUpdated', { detail: { reason: 'LanguageChanged' } }));\n      console.log(`[CMSCureSDK] Language changed to: ${language}`);\n    } else {\n      console.warn(`[CMSCureSDK] Language '${language}' is not available.`);\n    }\n  }\n\n  /**\n   * Gets all available languages\n   * @returns {string[]} Array of available language codes\n   */\n  getAvailableLanguages() {\n    return this.#availableLanguages;\n  }\n\n  /**\n   * Gets a translation for a specific key and tab\n   * @param {string} key - Translation key\n   * @param {string} tab - Tab name (e.g., 'common', 'homepage')\n   * @returns {string} Translated string or key if not found\n   */\n  translation(key, tab) {\n    const value = this.#cache[tab]?.[this.#currentLanguage]?.[key];\n    return value || `[${key}]`;\n  }\n\n  /**\n   * Gets a color value by key\n   * @param {string} key - Color key\n   * @returns {string|null} Color value or null if not found\n   */\n  color(key) {\n    const colorData = this.#cache['__colors__']?.[key];\n    \n    // Handle different color data formats\n    if (typeof colorData === 'string') {\n      return colorData; // Direct color string\n    }\n    if (typeof colorData === 'object' && colorData !== null) {\n      return colorData.hex || colorData.value || colorData.color || null;\n    }\n    \n    return null;\n  }\n\n  /**\n   * Gets an image URL by key\n   * @param {string} key - Image key\n   * @returns {string|null} Image URL or null if not found\n   */\n  image(key) {\n    return this.#cache['__images__']?.[key] || null;\n  }\n\n  /**\n   * Gets data store items by API identifier\n   * @param {string} apiIdentifier - Data store API identifier\n   * @returns {Array} Array of data store items\n   */\n  dataStore(apiIdentifier) {\n    return this.#dataStoreCache[apiIdentifier] || [];\n  }\n\n  /**\n   * Forces a refresh of all content\n   * @returns {Promise<void>}\n   */\n  async refresh() {\n    if (!this.#config) {\n      console.warn('[CMSCureSDK] Cannot refresh: SDK not configured');\n      return;\n    }\n    \n    console.log('[CMSCureSDK] Refreshing content...');\n    await this.#authenticateAndSync();\n    this.dispatchEvent(new CustomEvent('contentUpdated', { detail: { reason: 'Manual refresh' } }));\n  }\n\n  /**\n   * Loads cached state from localStorage\n   * @private\n   */\n  #loadStateFromStorage() {\n    try {\n      // Load cached auth token\n      const token = localStorage.getItem('cmscure_auth_token');\n      const languages = localStorage.getItem('cmscure_available_languages');\n      const currentLang = localStorage.getItem('cmscure_current_language');\n      const cacheData = localStorage.getItem('cmscure_cache');\n      const dataStoreCacheData = localStorage.getItem('cmscure_datastore_cache');\n\n      if (token) this.#authToken = token;\n      if (languages) this.#availableLanguages = JSON.parse(languages);\n      if (currentLang && this.#availableLanguages.includes(currentLang)) {\n        this.#currentLanguage = currentLang;\n      }\n      if (cacheData) this.#cache = JSON.parse(cacheData);\n      if (dataStoreCacheData) this.#dataStoreCache = JSON.parse(dataStoreCacheData);\n\n      console.log(`[CMSCureSDK] Loaded state. Current language: ${this.#currentLanguage}`);\n    } catch (error) {\n      console.warn('[CMSCureSDK] Failed to load cached state:', error.message);\n    }\n  }\n\n  /**\n   * Saves current state to localStorage\n   * @private\n   */\n  #saveStateToStorage() {\n    try {\n      if (this.#authToken) localStorage.setItem('cmscure_auth_token', this.#authToken);\n      localStorage.setItem('cmscure_available_languages', JSON.stringify(this.#availableLanguages));\n      localStorage.setItem('cmscure_current_language', this.#currentLanguage);\n      localStorage.setItem('cmscure_cache', JSON.stringify(this.#cache));\n      localStorage.setItem('cmscure_datastore_cache', JSON.stringify(this.#dataStoreCache));\n    } catch (error) {\n      console.warn('[CMSCureSDK] Failed to save state:', error.message);\n    }\n  }\n\n  /**\n   * Authenticates with the server and syncs all content\n   * @private\n   */\n  async #authenticateAndSync() {\n    if (!this.#config) {\n      console.error('[CMSCureSDK] Configuration not set. Call configure() first.');\n      return;\n    }\n\n    try {\n      console.log('[CMSCureSDK] Authenticating...');\n            \n      const response = await fetch(`${this.#serverUrl}/api/sdk/auth`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          projectId: this.#config.projectId,\n          apiKey: this.#config.apiKey\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Authentication failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n            \n      if (!data.success) {\n        throw new Error('Authentication failed');\n      }\n\n      this.#authToken = data.token;\n      this.#availableLanguages = data.availableLanguages || ['en'];\n\n      // Save to localStorage\n      localStorage.setItem('cmscure_auth_token', this.#authToken);\n      localStorage.setItem('cmscure_available_languages', JSON.stringify(this.#availableLanguages));\n\n      console.log('[CMSCureSDK] Authentication successful. Available languages:', this.#availableLanguages);\n      console.log('[CMSCureSDK] Syncing all content...');\n\n      // Create a list of all sync operations to run in parallel\n      const syncPromises = [\n        ...data.tabs.map(tab => this.#syncTab(tab)),\n        ...data.stores.map(store => this.#syncStore(store)),\n        this.#syncColors(),\n        this.#syncImages()\n      ];\n\n      await Promise.all(syncPromises);\n            \n      console.log('[CMSCureSDK] Initial sync complete.');\n      this.#saveStateToStorage();\n      this.dispatchEvent(new CustomEvent('contentUpdated', { detail: { reason: 'Initial sync' } }));\n            \n    } catch (error) {\n      console.error('[CMSCureSDK] Authentication or sync failed:', error.message);\n      throw error;\n    }\n  }\n\n  /**\n   * Syncs translations for a specific tab\n   * @private\n   */\n  async #syncTab(tab) {\n    try {\n      const response = await fetch(`${this.#serverUrl}/api/sdk/translations/${this.#config.projectId}/${tab}`, {\n        headers: { 'Authorization': `Bearer ${this.#authToken}` }\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        if (!this.#cache[tab]) this.#cache[tab] = {};\n        \n        // Process the keys array from API response\n        if (data.keys && Array.isArray(data.keys)) {\n          data.keys.forEach(keyObj => {\n            const { key, values } = keyObj;\n            // Restructure: values = {en: \"value\", fr: \"valeur\"} \n            // Into: cache[tab][lang][key] = value\n            Object.keys(values).forEach(lang => {\n              if (!this.#cache[tab][lang]) this.#cache[tab][lang] = {};\n              this.#cache[tab][lang][key] = values[lang];\n            });\n          });\n        }\n        \n        console.log(`[CMSCureSDK] Synced tab: ${tab}`);\n      } else {\n        console.warn(`[CMSCureSDK] Failed to sync tab ${tab}: ${response.status}`);\n      }\n    } catch (error) {\n      console.error(`[CMSCureSDK] Error syncing tab ${tab}:`, error.message);\n    }\n  }\n\n  /**\n   * Syncs images from server\n   * @private\n   */\n  async #syncImages() {\n    try {\n      const response = await fetch(`${this.#serverUrl}/api/sdk/images/${this.#config.projectId}`, {\n        headers: { 'Authorization': `Bearer ${this.#authToken}` }\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        \n        // Transform array format [{key: \"name\", url: \"...\"}] into object format {name: \"...\"}\n        const imagesObj = {};\n        if (Array.isArray(data)) {\n          data.forEach(imageItem => {\n            if (imageItem.key && imageItem.url) {\n              imagesObj[imageItem.key] = imageItem.url;\n            }\n          });\n        } else {\n          // If it's already an object, use as-is\n          Object.assign(imagesObj, data);\n        }\n        \n        this.#cache['__images__'] = imagesObj;\n        console.log('[CMSCureSDK] Synced images:', imagesObj);\n      } else {\n        console.warn(`[CMSCureSDK] Failed to sync images: ${response.status}`);\n      }\n    } catch (error) {\n      console.error('[CMSCureSDK] Error syncing images:', error.message);\n    }\n  }\n\n  /**\n   * Syncs colors from server\n   * @private\n   */\n  async #syncColors() {\n    try {\n      const response = await fetch(`${this.#serverUrl}/api/sdk/colors/${this.#config.projectId}`, {\n        headers: { 'Authorization': `Bearer ${this.#authToken}` }\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        \n        // Transform array format [{key: \"name\", value: \"#hex\"}] into object format {name: \"#hex\"}\n        const colorsObj = {};\n        if (Array.isArray(data)) {\n          data.forEach(colorItem => {\n            if (colorItem.key && colorItem.value) {\n              colorsObj[colorItem.key] = colorItem.value;\n            }\n          });\n        } else {\n          // If it's already an object, use as-is\n          Object.assign(colorsObj, data);\n        }\n        \n        this.#cache['__colors__'] = colorsObj;\n        console.log('[CMSCureSDK] Synced colors:', colorsObj);\n      } else {\n        console.warn(`[CMSCureSDK] Failed to sync colors: ${response.status}`);\n      }\n    } catch (error) {\n      console.error('[CMSCureSDK] Error syncing colors:', error.message);\n    }\n  }\n\n  /**\n   * Syncs a data store from server\n   * @private\n   */\n  async #syncStore(apiIdentifier) {\n    try {\n      const response = await fetch(`${this.#serverUrl}/api/sdk/store/${this.#config.projectId}/${apiIdentifier}`, {\n        headers: { 'Authorization': `Bearer ${this.#authToken}` }\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        this.#dataStoreCache[apiIdentifier] = data;\n        console.log(`[CMSCureSDK] Synced data store: ${apiIdentifier}`);\n      } else {\n        console.warn(`[CMSCureSDK] Failed to sync data store ${apiIdentifier}: ${response.status}`);\n      }\n    } catch (error) {\n      console.error(`[CMSCureSDK] Error syncing data store ${apiIdentifier}:`, error.message);\n    }\n  }\n}\n\n// Make SDK available globally for browser environments\nif (typeof window !== 'undefined') {\n  window.CMSCureSDK = CMSCureSDK;\n}\n\n// For CommonJS environments  \nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = CMSCureSDK;\n}\n\n// For AMD/RequireJS environments\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return CMSCureSDK;\n  });\n}\n\n// Export the class as default for ES modules (if supported)\nif (typeof exports !== 'undefined') {\n  exports.default = CMSCureSDK;\n}\n"],"names":[],"mappings":"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"}